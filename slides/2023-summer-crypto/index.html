<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.6.0 for Hugo"><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu1b90dea3b5752ec4ed6154c0dc881a21_30314_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu1b90dea3b5752ec4ed6154c0dc881a21_30314_192x192_fill_lanczos_center_3.png><link rel=canonical href=https://example.com/slides/2023-summer-crypto/><title>A Brief Introduction to Cryptography in CTF Games | Luminolt</title><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/theme/black.min.css><link rel=stylesheet href=/css/libs/chroma/github-dark.min.css><link rel=stylesheet href=/css/reveal_custom.min.css></head><body><div class=reveal><div class=slides><section><style>.reveal .slide-number{display:none}.reveal h2{font-size:48px;border-bottom:2px solid #b7c6df;padding-bottom:20px}.reveal h1,.reveal h2,.reveal h3,.reveal h4,.reveal h5,.reveal h6{text-align:left;margin:0 0 20px;color:#fff;font-weight:400;line-height:1.2;letter-spacing:normal}</style><div class="middle center"><div style=width:100%><h1 id=a-brief-introduction-to-cryptography-in-ctf-games>A Brief Introduction to Cryptography in CTF Games</h1><p>Chenghao Chen | 2022.6</p><p>Shanghai University</p></section><section><h2 id=outline>Outline?!</h2><br><ol><li>密码和编码</li><li>古典密码学</li><li>对称密码学</li><li>Hash 函数</li><li>近世代数和数论</li><li>非对称密码</li><li>范畴论和同态加密</li><li>格论和格密码</li></ol><p><img style=position:absolute;right:30%;top:50%;transform:translate(50%,-50%) width=25% src="https://picx.zhimg.com/80/v2-90f3ef45d2fbbd492dd36def9c1e5f53_720w.webp?source=1940ef5c"></p></section><section><h2 id=outline-1>Outline</h2><p><br><br></p><ol><li>密码和编码</li><li>近世代数和数论</li><li>非对称密码-RSA</li><li>Challenges</li></ol><p><img style=position:absolute;right:30%;top:65%;transform:translate(50%,-50%) width=25% src="https://th.bing.com/th/id/OIP.yuNmwCWteG3UH5sRuIAAPgHaGX?pid=ImgDet&rs=1"></p></section><section><div class="middle center"><div style=width:100%><h1 id=l1-密码和编码>L1. 密码和编码</h1><p>实际上是一个引言，并且介绍了 ancient 神必编码</p></section><section><h2 id=11-一些会被搞混的术语>1.1 一些会被搞混的术语</h2><ul><li>密码（Cryptography）：用于保护信息安全的过程<ul><li><code>Encrypt(k, m)</code></li><li><code>Decrypt(k, c)</code></li></ul></li><li>编码（Code Theory）：信息转换为不同形式的过程<ul><li><code>Encode(m)</code></li><li><code>Decode(e)</code></li></ul></li><li>口令（Password）：用户登录的凭证</li><li>散列（Hash）：（抗碰撞的）单向的压缩函数</li></ul></section><section><h2 id=12-常见编码方法>1.2 常见编码方法</h2><p>实用编码方法：</p><ul><li>字符编码：ASCII, Unicode</li><li>二进制数据编码：base, Hex</li><li>URL编码：e.g. <code>' '</code> -> <code>%20</code></li></ul><p>玩具编码方法：</p><ul><li>与佛论禅：e.g. 佛曰：俱利知曳罰陀那無呐諦梵多不僧室得諳有呐跋姪阿</li><li>兽音译者：e.g. ~呜嗷呜呜呜呜~啊啊啊啊</li></ul></section><section><h2 id=121-字符编码转换错误>1.2.1 字符编码转换错误</h2><p>（一种比较古老的题目）</p><ul><li>古早的时候编码标准不统一，会产生乱码</li><li>GBK, BIG5, UTF-8</li><li>e.g.:<ul><li>（打开编码 UTF-8）��ѽѽѽѽѽѽ</li><li>（实际编码GBK）哇呀呀呀呀呀呀</li></ul></li></ul></section><section><h2 id=122-锟斤拷>1.2.2 锟斤拷</h2><ul><li>Replacement Character �</li></ul><p>🤔 锟斤拷</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;</span> <span class=s1>&#39;�&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xef\xbf\xbd</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;</span> <span class=s1>&#39;锟斤拷&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;gbk&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\xef\xbf\xbd\xef\xbf\xbd</span><span class=s1>&#39;</span>
</span></span></code></pre></div><ul><li>🤷随着文本替换，信息丢失</li></ul></section><section><h2 id=123-base64>1.2.3 base64</h2><p>base64</p><ul><li>二进制-文本间的编码方法</li><li>64个编码字符（<code>'A-Za-z0-9+/'</code>）</li><li>$64 = 2^6$，因而 base64 编码的码字可以表示6个bit的信息</li><li>（<a href=https://c.runoob.com/front-end/693/ target=_blank rel=noopener>编码表</a>）</li></ul><p>🤔1个ASCII编码字符 8 bit，base64 一个码字 6 bit</p><p>如何编码？</p></section><section><h2 id=124-base64-padding>1.2.4 base64 padding</h2><ul><li>padding rule: <code>'0'</code>字符填充</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nd>@Utils.print_params</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>encode_b64_with_ascii_bin</span><span class=p>(</span><span class=n>text</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>binary_text</span>  <span class=o>=</span> <span class=s1>&#39; &#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>format</span><span class=p>(</span><span class=nb>ord</span><span class=p>(</span><span class=n>char</span><span class=p>),</span> <span class=s1>&#39;08b&#39;</span><span class=p>)</span> <span class=k>for</span> <span class=n>char</span> <span class=ow>in</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>encoded_text</span> <span class=o>=</span> <span class=n>base64</span><span class=o>.</span><span class=n>b64encode</span><span class=p>(</span><span class=n>text</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;ascii&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>binary_text</span><span class=p>,</span> <span class=n>encoded_text</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>encode_b64_with_ascii_bin</span><span class=p>(</span><span class=s1>&#39;1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Result</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;00110001&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;MQ==&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>encode_b64_with_ascii_bin</span><span class=p>(</span><span class=s1>&#39;12&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Result</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;00110001 00110010&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;MTI=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>encode_b64_with_ascii_bin</span><span class=p>(</span><span class=s1>&#39;123&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Result</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;00110001 00110010 00110011&#39;</span><span class=p>,</span> <span class=sa>b</span><span class=s1>&#39;MTIz&#39;</span><span class=p>)</span>
</span></span></code></pre></div></section><section><h2 id=124-base64-padding-contd>1.2.4 base64 padding (Cont&rsquo;d)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>00110001
</span></span><span class=line><span class=cl>001100 01
</span></span><span class=line><span class=cl>001100 010000
</span></span><span class=line><span class=cl>MQ==
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>00110001 00110010
</span></span><span class=line><span class=cl>001100 010011 0010
</span></span><span class=line><span class=cl>001100 010011 001000
</span></span><span class=line><span class=cl>MTI=
</span></span></code></pre></div><ul><li>发现等号可以考虑base64解码</li></ul></section><section><h2 id=13-哈希函数>1.3 哈希函数</h2><ul><li>典：</li></ul><p><img alt class=center src=https://picgo-1303220879.cos.ap-shanghai.myqcloud.com//img20230613142148.png></p><ul><li>哈希不是加密</li><li>虽然网上很多在线哈希都是加密（<a href=https://www.sojson.com/md5/ target=_blank rel=noopener>例子</a>）</li></ul></section><section><h2 id=14-彩虹表>1.4 彩虹表</h2><p><img alt class=center src=https://upload.wikimedia.org/wikipedia/commons/5/53/Dr._Oechslin_Rainbow_Table_Crypto_2003_Illustration.png></p></section><section><div class="middle center"><div style=width:100%><h1 id=l2-近世代数和数论>L2. 近世代数和数论</h1><p>中科院少年班招生要求：手撕大素数分解</p></section><section><h2 id=21-数论>2.1 数论</h2><ul><li>整除</li><li>素数和互素</li><li>算数基本定理<ul><li>$N = p_1^{a_1}p_2^{a_2}\cdots p_k^{a_k}$</li></ul></li><li>最大公约数（Greatest Common Divisor, GCD）<ul><li>Euclidean 算法</li><li>扩展 Euclidean 算法<ul><li>$ax + by = \mathrm{gcd}(x, y)$</li><li>$ax + by = 1 \Rightarrow ax = -by + 1$</li><li>$\Rightarrow ax \equiv 1 (\bmod y)$ （$\mathbb{F}_p$上自然成立）</li></ul></li></ul></li></ul></section><section><h2 id=22-模运算算数性质>2.2 模运算算数性质</h2><ul><li>let $[\cdot]$ denotes $(\cdot) \bmod n$</li><li>$[[a]] = [a]$</li><li>$[a] + [b] = [a+b]$</li><li>$[a] - [b] = [a-b]$</li><li>$[a \times b] = [[a] \times [b]]$</li><li>$[a^k] = [[a]^k]$</li></ul></section><section><h2 id=23-更多知识>2.3 更多知识</h2><ul><li>Fermat 小定理</li><li>Euler 函数</li><li>中国剩余定理</li><li>连分数</li><li>……</li></ul></section><section><div class="middle center"><div style=width:100%><h1 id=l3-非对称密码学>L3. 非对称密码学</h1><p>textbook RSA，但不会</p></section><section><h2 id=31-非对称密码学基础>3.1 非对称密码学基础</h2><ul><li><p>安全的单向陷门函数</p></li><li><p>利用Hash的构造……</p></li><li><p>↑ 在CTF中不是很重要</p></li></ul><p>关注点：</p><ul><li>选取素数的算数特性</li><li>不合理的加密指数、解密指数选取</li><li>不合理的加密方案修改</li></ul></section><section><h2 id=32-textbook-rsa>3.2 textbook RSA</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>invert</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>phi_n</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>invert</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>phi_n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;Hello, world!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>c</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>m_</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m_</span><span class=p>))</span>
</span></span></code></pre></div></section><section><h2 id=32-textbook-rsa-contd>3.2 textbook RSA (Cont&rsquo;d)</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>phi_n</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>Euler 函数：小于等于$n$的与$n$互素的正整数的个数</li><li>$\varphi(n) = \varphi(pq) = \varphi(p) \varphi(q) = (p-1)(q-1)$</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m_</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>$(m^e \bmod n)^d \bmod n = m^{ed} \bmod n$</li><li>$ed = 1 \bmod \varphi(n)\Rightarrow ed = 1 + k\varphi(n)$</li><li>$m^{ed} \bmod n = m^{1+k\varphi(n)} \bmod n$</li></ul></section><section><h2 id=32-textbook-rsa-contd-1>3.2 textbook RSA (Cont&rsquo;d)</h2><ul><li>$m^{ed} \bmod n = m^{1+k\varphi(n)} \bmod n$</li><li>$= (m \bmod n)(m^{k\varphi(n)} \bmod n) $</li><li>$= (m \bmod n)(m^{\varphi(n)} \bmod n)^k \bmod n $</li></ul><p>Euler 定理：若$m$ 和$n$ 互素，则$m^{\varphi(n)}\equiv 1 (\bmod n)$</p><ul><li><p>$n = pq, m &lt; p, m &lt; q$</p></li><li><p>$m^{ed} \bmod n = (m \bmod n) (1)^k \bmod n$</p></li><li><p>$= m \bmod n$</p></li></ul></section><section><h2 id=33-n-分解攻击>3.3 N 分解攻击</h2><p>一种显然的攻击方法</p><ul><li>小p, q<ul><li>因式分解</li></ul></li><li>p, q 差值太小或太大<ul><li>Fermat, Pollard Rho 方法分解</li></ul></li></ul><p>工具：</p><ul><li><a href=https://sourceforge.net/projects/yafu/ target=_blank rel=noopener>yafu</a></li><li><a href=https://www.alpertron.com.ar/ECM.HTM target=_blank rel=noopener>Integer factorization calculator</a></li></ul></section><section><h2 id=331-example-1---factor>3.3.1 Example 1 - Factor</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>secret</span> <span class=kn>import</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>128</span><span class=p>);</span> <span class=n>q</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>128</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span><span class=p>;</span> <span class=n>phi_n</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>e</span><span class=p>);</span> <span class=nb>print</span><span class=p>(</span><span class=n>n</span><span class=p>);</span> <span class=nb>print</span><span class=p>(</span><span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 65537</span>
</span></span><span class=line><span class=cl><span class=c1># 60312637199635801058227385421553206347253918440828187249920737695124886809487</span>
</span></span><span class=line><span class=cl><span class=c1># 14673748133379805475254231366717984351237192567008318062632171353909225806981</span>
</span></span></code></pre></div></section><section><h2 id=332-example-1-try>3.3.2 Example 1 try</h2><ul><li>浅浅分解一下</li></ul><p><img alt=center width=70% src=https://picgo-1303220879.cos.ap-shanghai.myqcloud.com//img20230613164825.png></p><ul><li>3分钟出结果</li></ul></section><section><h2 id=333-example-1-poc>3.3.3 Example 1 poc</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>invert</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>60312637199635801058227385421553206347253918440828187249920737695124886809487</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>14673748133379805475254231366717984351237192567008318062632171353909225806981</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=mi>197_171715_027747_339553_722339_715394_949697</span>
</span></span><span class=line><span class=cl><span class=n>q</span> <span class=o>=</span> <span class=mi>305_888890_762796_266901_267235_667077_573071</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>phi_n</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>d</span> <span class=o>=</span> <span class=n>invert</span><span class=p>(</span><span class=n>e</span><span class=p>,</span> <span class=n>phi_n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span> <span class=n>d</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># b&#39;flag{waaaaa!}&#39;</span>
</span></span></code></pre></div></section><section><h2 id=34-小加密指数攻击>3.4 小加密指数攻击</h2><ul><li>加密指数极小时，发生相关攻击（如$e=3$）</li><li>此时：<ul><li>$c \equiv m^3(\bmod n)$</li><li>$m^3 = c + kn$</li><li>$m = (c+kn)^{1/3}$</li></ul></li></ul><p>攻击方法：Brute-force $k$</p></section><section><h2 id=341-example-2---low-enc-exp>3.4.1 Example 2 - Low-Enc-Exp</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>invert</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>secret</span> <span class=kn>import</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>1024</span><span class=p>);</span> <span class=n>q</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>phi_n</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=c1># 26904410424513850825570476100349039892015194282487533873593315635034916011599061467392303815306522302238291633926964464814719214360401710146660376698471334910919067631926359580676153648632072950953163800307452838629641502897202385008108650370210545081025594811346683868462241559023145711983469942804412184091372375410284776347467254451154229882893062676381167273759770532779269018405250741326382414128740659109901734318180074363144722523208937640098203271310259652100969148051051093951864097917984729026851490884006661280087277384483099665162338506927680335934552565079554069982479529726554065109787187999302935991923</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>c</span><span class=p>)</span> <span class=c1># 31850476042869993856571693940454371912053546150176657900652418191965217904787395659877</span>
</span></span></code></pre></div></section><section><h2 id=342-example-2-poc>3.4.2 Example 2 poc</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>invert</span><span class=p>,</span> <span class=n>iroot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e</span> <span class=o>=</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>26904410424513850825570476100349039892015194282487533873593315635034916011599061467392303815306522302238291633926964464814719214360401710146660376698471334910919067631926359580676153648632072950953163800307452838629641502897202385008108650370210545081025594811346683868462241559023145711983469942804412184091372375410284776347467254451154229882893062676381167273759770532779269018405250741326382414128740659109901734318180074363144722523208937640098203271310259652100969148051051093951864097917984729026851490884006661280087277384483099665162338506927680335934552565079554069982479529726554065109787187999302935991923</span>
</span></span><span class=line><span class=cl><span class=n>c</span> <span class=o>=</span> <span class=mi>31850476042869993856571693940454371912053546150176657900652418191965217904787395659877</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span> <span class=o>=</span> <span class=n>iroot</span><span class=p>(</span><span class=n>c</span><span class=o>+</span><span class=n>i</span><span class=o>*</span><span class=n>n</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>res</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=se>\r</span><span class=s1> i = </span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># b&#39;flag{yeahh!}&#39;</span>
</span></span></code></pre></div></section><section><h2 id=35-共模攻击>3.5 共模攻击</h2><ul><li><p>为什么 $n$ 每次都要重新生成？</p></li><li><p>假设重复利用 $n$</p><ul><li>$m^{e_1}\equiv c_1(\bmod n)$</li><li>$m^{e_2}\equiv c_2(\bmod n)$</li></ul></li><li><p>攻击利用扩展 Euclidean算法（$ae_1+be_2\equiv1 (\bmod n)$）</p><ul><li>此时$m^{ae_1+be_2} = c_1^{a}c_2^{b} \bmod n$</li></ul></li></ul></section><section><h2 id=351-example-3---mod-share>3.5.1 Example 3 - Mod Share</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>invert</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>secret</span> <span class=kn>import</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>p</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>1024</span><span class=p>);</span> <span class=n>q</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>1024</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=n>p</span> <span class=o>*</span> <span class=n>q</span><span class=p>;</span> <span class=n>phi_n</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=n>q</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>64</span><span class=p>);</span> <span class=n>e2</span> <span class=o>=</span> <span class=n>getPrime</span><span class=p>(</span><span class=mi>64</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>bytes_to_long</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e1</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=n>e2</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>  <span class=c1># 15170797923892054990521305052012509493080568087081023750033741867542316768999951573646413753990834682138025772136109204509899638782616660243658254139599441045875522966283555995043016187825383943336990507193641549144516174056706810327582160942467845635495500282175716057977476074952304306822781341844677001797438535701007875365722512160465708455832225273446521621543823855283418665848061608565467010656663089973001969597624553258295614154262448569387247406903093192587512853122780974388687415079948784446715412138463084264315211437439421528085827503277507203193141860916227982534613135645331857382065795066181077972687</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>e1</span><span class=p>)</span> <span class=c1># 9576072468337167131</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>e2</span><span class=p>)</span> <span class=c1># 14939113163917820627</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>c1</span><span class=p>)</span> <span class=c1># 2513254454937818539320001229715025367247490957880668052989469295768681316833496719591412918630312453676811713071414028525870397074185767769616621123070069290764497635067026772298781749325373581840750494743329569059911576372085939972798876709058137797441729480657418587957036217376669515209286767084322875440709473172117549721159755662718590954657925357615152141194701388245440956597032994743626281679318033304014413523468865879100948882376690862202243813943679264465530741774092309002963261692618613612757084511814696332961571153968794051052454203918248339932068292297123047852899029619284314623645966095118119009347</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>c2</span><span class=p>)</span> <span class=c1># 111884194864476659139117439739496481475155670608279036093048194153438641356919888323493937575276768933859172174857427366301659912545016807339447507119749910478246208487569012877733924932126136220607107687643614867740936831894203006503190514539481184016080767542829000468460046831987529804871513461035761669072519101709086162745537847204230913330316446448321633091235409913844098851446548290633634428674269538902219278990312260703412892258533797387149328008600614619162876396153768090553946757954666629947494973412821804101257176286021758524844324847062425088549302146311886502815379004832574784487510491117203079999</span>
</span></span></code></pre></div></section><section><h2 id=352-example-3-poc>3.5.2 Example 3 poc</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span><span class=p>,</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>invert</span><span class=p>,</span> <span class=n>gcdext</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>15170797923892054990521305052012509493080568087081023750033741867542316768999951573646413753990834682138025772136109204509899638782616660243658254139599441045875522966283555995043016187825383943336990507193641549144516174056706810327582160942467845635495500282175716057977476074952304306822781341844677001797438535701007875365722512160465708455832225273446521621543823855283418665848061608565467010656663089973001969597624553258295614154262448569387247406903093192587512853122780974388687415079948784446715412138463084264315211437439421528085827503277507203193141860916227982534613135645331857382065795066181077972687</span>
</span></span><span class=line><span class=cl><span class=n>e1</span> <span class=o>=</span> <span class=mi>9576072468337167131</span>
</span></span><span class=line><span class=cl><span class=n>e2</span> <span class=o>=</span> <span class=mi>14939113163917820627</span>
</span></span><span class=line><span class=cl><span class=n>c1</span> <span class=o>=</span> <span class=mi>2513254454937818539320001229715025367247490957880668052989469295768681316833496719591412918630312453676811713071414028525870397074185767769616621123070069290764497635067026772298781749325373581840750494743329569059911576372085939972798876709058137797441729480657418587957036217376669515209286767084322875440709473172117549721159755662718590954657925357615152141194701388245440956597032994743626281679318033304014413523468865879100948882376690862202243813943679264465530741774092309002963261692618613612757084511814696332961571153968794051052454203918248339932068292297123047852899029619284314623645966095118119009347</span>
</span></span><span class=line><span class=cl><span class=n>c2</span> <span class=o>=</span> <span class=mi>111884194864476659139117439739496481475155670608279036093048194153438641356919888323493937575276768933859172174857427366301659912545016807339447507119749910478246208487569012877733924932126136220607107687643614867740936831894203006503190514539481184016080767542829000468460046831987529804871513461035761669072519101709086162745537847204230913330316446448321633091235409913844098851446548290633634428674269538902219278990312260703412892258533797387149328008600614619162876396153768090553946757954666629947494973412821804101257176286021758524844324847062425088549302146311886502815379004832574784487510491117203079999</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>gcd</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span> <span class=o>=</span> <span class=n>gcdext</span><span class=p>(</span><span class=n>e1</span><span class=p>,</span> <span class=n>e2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c1</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>*</span> <span class=nb>pow</span><span class=p>(</span><span class=n>c2</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>n</span><span class=p>)</span> <span class=o>%</span> <span class=n>n</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span> <span class=c1># b&#39;flag{zzZzzz}&#39;</span>
</span></span></code></pre></div></section><section><h2 id=36-more-exercise-1>3.6 More Exercise 1</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>n=111579281253062835933426384911624147476643761873859056052262953708472502295896995336206948247132120107672205900512683609160859648751240065855474276219994138942756004010593263891617114133265991974868701112328627021663637323794664244913574481420588357101626589818721266368311914527609221633764177929512932572431
</span></span><span class=line><span class=cl>c=88870500129800281970105647465034249962408043895876390636948381637648563368839286409491487914616157808689098599152353765340352358559100732226540197353569675894540877184980032542071641988321773490955995436271805369857124988164094166523947397743529988209384145974211768757896487704118410946032129361588104389830
</span></span><span class=line><span class=cl>e=65537
</span></span></code></pre></div></section><section><h2 id=361-poc>3.6.1 poc</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>gmpy2</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sympy</span> <span class=kn>import</span> <span class=n>nextprime</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>n</span><span class=o>=</span><span class=mi>111579281253062835933426384911624147476643761873859056052262953708472502295896995336206948247132120107672205900512683609160859648751240065855474276219994138942756004010593263891617114133265991974868701112328627021663637323794664244913574481420588357101626589818721266368311914527609221633764177929512932572431</span>
</span></span><span class=line><span class=cl><span class=n>c</span><span class=o>=</span><span class=mi>88870500129800281970105647465034249962408043895876390636948381637648563368839286409491487914616157808689098599152353765340352358559100732226540197353569675894540877184980032542071641988321773490955995436271805369857124988164094166523947397743529988209384145974211768757896487704118410946032129361588104389830</span>
</span></span><span class=line><span class=cl><span class=n>e</span><span class=o>=</span><span class=mi>65537</span>
</span></span><span class=line><span class=cl><span class=n>q</span><span class=o>=</span><span class=n>nextprime</span><span class=p>(</span><span class=n>gmpy2</span><span class=o>.</span><span class=n>iroot</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=n>p</span><span class=o>=</span><span class=n>n</span><span class=o>//</span><span class=n>q</span>
</span></span><span class=line><span class=cl><span class=n>d</span><span class=o>=</span><span class=n>gmpy2</span><span class=o>.</span><span class=n>invert</span><span class=p>(</span><span class=n>e</span><span class=p>,(</span><span class=n>p</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span><span class=o>*</span><span class=p>(</span><span class=n>q</span><span class=o>-</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>m</span><span class=o>=</span><span class=nb>pow</span><span class=p>(</span><span class=n>c</span><span class=p>,</span><span class=n>d</span><span class=p>,</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>long_to_bytes</span><span class=p>(</span><span class=n>m</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#flag{llsajdjlksajldjsdjkl}</span>
</span></span></code></pre></div></section><section><h2 id=37-wieners-rsa-attack>3.7 Wiener&rsquo;s RSA Attack</h2><ul><li>小解密指数攻击（$d&lt;1/3n^{1/4}$）</li><li>连分数<ul><li>$x = a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{a_3 + \cfrac{1}{\ddots,}}}} $</li><li>$x = [a_0, a_1, a_2, \cdots]$</li></ul></li></ul><h2 id=37-wieners-rsa-attack-contd>3.7 Wiener&rsquo;s RSA Attack (Cont&rsquo;d)</h2><ul><li>$ed = 1 + k\varphi(N)$</li><li>$\left| \frac{e}{\varphi(N)} - \frac{k}{d}\right| = \frac{1}{d\varphi(N)}$</li><li>若$N$足够大，则$k/d$是对$e/\varphi(N)$ 的估计</li><li>敌手只有$e$和$N$，但是$\varphi(N) \approx N$</li></ul><p>Wiener&rsquo;s Theorem</p><ul><li>$k/d$ 可以在多项式时间内从$e/N$的连分数中找到</li><li>测试$k&rsquo;, d&rsquo;$，若$(ed-1) \bmod k = 0$</li></ul></section><section><h2 id=371-more-exercise-2>3.7.1 More Exercise 2</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>RSA:
</span></span><span class=line><span class=cl>n=56661243519426563299920058134092862370737397949947210394843021856477420959615132553610830104961645574615005956183703191006421508461009698780382360943562001485153455401650697532951591191737164547520951628336941289873198979641173541232117518791706826699650307105202062429672725308809988269372149027026719779368169
</span></span><span class=line><span class=cl>e=36269788044703267426177340992826172140174404390577736281478891381612294207666891529019937732720246602062358244751177942289155662197410594434293004130952671354973700999803850153697545606312859272554835232089533366743867361181786472126124169787094837977468259794816050397735724313560434944684790818009385459207329
</span></span><span class=line><span class=cl>c=137954301101369152742229874240507191901061563449586247819350394387527789763579249250710679911626270895090455502283455665178389917777053863730286065809459077858674885530015624798882224173066151402222862023045940035652321621761390317038440821354117827990307003831352154618952447402389360183594248381165728338233
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>BASE:
</span></span><span class=line><span class=cl>&#34;GHI45FQRSCX****UVWJK67DELMNOPAB3&#34;
</span></span></code></pre></div></section><section><div class="middle center"><div style=width:100%><h1 id=challenge>Challenge</h1><p>上强度</p></section><section><h2 id=chal1-套娃>Chal1. 套娃</h2><ul><li>本题共有3个flag</li><li>所有flag的形式均为<code>'flag{[0-9A-Za-z=_]*}'</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>新佛曰：諸隸僧降冥吽諸陀摩隸僧缽冥薩願耨咤陀
</span></span><span class=line><span class=cl>願羅咤喃迦祗蜜耨阿嚤僧喼所聞薩闍嚩聞念須亦心
</span></span><span class=line><span class=cl>耨冥心阿冥聞慧蜜咤冥心念訶冥嚩冥聞冥念降咤冥
</span></span><span class=line><span class=cl>劫耨降寂願慧般祗闍隸冥修阿闍莊陀冥莊冥劫莊嚴
</span></span><span class=line><span class=cl>冥宣隸阿摩嚩蜜心咒冥闍我須咒慧冥闍諦羅迦聞慧
</span></span><span class=line><span class=cl>婆劫嘚慧咒迦慧慧我慧冥闍念劫嘇隸蜜祗伏嚤慧咒
</span></span><span class=line><span class=cl>修缽聞色祗冥闍僧嘚迦降阿莊冥慧聞蜜降咤寂波嘇
</span></span><span class=line><span class=cl>塞薩如囑
</span></span></code></pre></div></section><section><h2 id=chal2-ezrsa>Chal2. ezRSA</h2><ul><li>本题仅1个flag</li><li>flag的形式均为<code>'flag{[0-9A-Za-z=_]*}'</code></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>getPrime</span><span class=p>,</span> <span class=n>bytes_to_long</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>gmpy2</span> <span class=kn>import</span> <span class=n>is_prime</span><span class=p>,</span> <span class=n>invert</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>typing</span> <span class=kn>import</span> <span class=n>Tuple</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>secert</span> <span class=kn>import</span> <span class=n>flag</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>gen_rsa_param</span><span class=p>()</span> <span class=o>-&gt;</span> <span class=n>Tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span> <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>rsa_encrypt</span><span class=p>(</span><span class=n>m</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>gen_rsa_param</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>rsa_encrypt</span><span class=p>(</span><span class=n>flag</span><span class=p>,</span> <span class=o>*</span><span class=n>params</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>params</span><span class=p>[</span><span class=mi>2</span><span class=p>])</span>
</span></span><span class=line><span class=cl><span class=c1># 5796768148637887491255587039409951397511832995737366433505141785703232675749200657380232851343254281355390391562734825283953711907092653161783752372166386</span>
</span></span><span class=line><span class=cl><span class=c1># 7948512242985881433771203281939490726039994357587772712416312873824297606161653053722572268861029945737411249803561023517431875922105282741637330609169129</span>
</span></span></code></pre></div></section></div></div><script src=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/dist/reveal.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/markdown/markdown.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/notes/notes.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/search/search.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/math/math.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js@4.3.1/plugin/zoom/zoom.min.js crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/plugin.js integrity="sha256-M6JwAjnRAWmi+sbXURR/yAhWZKYhAw7YXnnLvIxrdGs=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.js integrity="sha256-l14dklFcW5mWar6w/9KaW0fWVerf3mYr7Wt0+rXzFAA=" crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/reveal.js-menu@2.1.0/menu.css integrity="sha256-0fU8HKLaTjgzfaV9CgSqbsN8ilA3zo6zK1M6rlgULd8=" crossorigin=anonymous><script src=/js/wowchemy-slides.js></script></body></html>